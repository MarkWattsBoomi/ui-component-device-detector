!function(t){var e={};function o(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=t,o.c=e,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=2)}([function(t,e){t.exports=React},function(t,e,o){"use strict";var n,r=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),a=function(t){function e(e){var o=t.call(this,e)||this;return o.googleMapsURL="https://maps.googleapis.com/maps/api/js?key=AIzaSyDZ2cbjJkFl5qygZYcKrcZVTzfX70G_-nY",o.onScriptLoaded=o.onScriptLoaded.bind(o),o}return r(e,t),e.prototype.componentDidMount=function(){this.addMapsScript()},e.prototype.addMapsScript=function(){var t=this;document.querySelectorAll('[src="'+this.googleMapsURL+'"]').length?this.onScriptLoaded():document.body.appendChild(Object.assign(document.createElement("script"),{type:"text/javascript",src:this.googleMapsURL,onload:function(){return t.onScriptLoaded()}}))},e.prototype.onScriptLoaded=function(){var t={center:{lng:parseFloat(this.props.centre.lng),lat:parseFloat(this.props.centre.lat)},zoom:parseInt(this.props.zoom)},e=new google.maps.Map(document.getElementById("map"),t);if(this.props.children)switch(Object.prototype.toString.call(this.props.children)){case"[object Array]":for(var o=this.props.children,n=0;n<o.length;n++){var r={position:{lng:parseFloat(o[n].props.center.lng),lat:parseFloat(o[n].props.center.lat)},map:e,title:o[n].props.title};new google.maps.Marker(r)}break;case"[object Object]":var i=this.props.children;r={position:{lng:parseFloat(i.props.center.lng),lat:parseFloat(i.props.center.lat)},map:e,title:i.props.title},new google.maps.Marker(r)}},e.prototype.render=function(){return i.createElement("div",{style:{width:"100%",height:"100%"},id:"map"})},e}(i.Component);e.default=a},function(t,e,o){"use strict";function n(t){for(var o in t)e.hasOwnProperty(o)||(e[o]=t[o])}Object.defineProperty(e,"__esModule",{value:!0}),n(o(3)),n(o(4)),n(o(1)),n(o(5))},function(t,e,o){"use strict";var n,r=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),a=function(t){function e(e){var o=t.call(this,e)||this;o.componentId="",o.flowKey="",o.attributes={},o.text="",o.componentId=e.id,o.flowKey=e.flowKey;var n=manywho.model.getComponent(o.props.id,o.props.flowKey);if(n.attributes)for(var r in n.attributes)o.attributes[r]=n.attributes[r];return o}return r(e,t),e.prototype.componentDidMount=function(){this.detectDevice()},e.prototype.componentDidUpdate=function(){},e.prototype.getAttribute=function(t){return this.attributes[t]?this.attributes[t]:null},e.prototype.render=function(){var t=manywho.model.getComponent(this.componentId,this.flowKey),e=manywho.state.getComponent(this.componentId,this.flowKey),o=(this.getAttribute("Title"),t.width+"px"),n=t.height+"px",r={};r.width=o,r.height=n;var a="OS:"+this.platform+" Browser:"+this.vendor+" - "+this.product+" Latitude:"+this.latitude+" Longitude:"+this.longitude;return e.contentValue=a,i.createElement("div",null,a)},e.prototype.imhere=function(t){this.latitude=t.coords.latitude,this.longitude=t.coords.longitude,this.forceUpdate()},e.prototype.detectDevice=function(){this.platform=navigator.platform,this.product=navigator.product,this.vendor=navigator.vendor,navigator.geolocation.getCurrentPosition(this.imhere.bind(this))},e}(i.Component);manywho.component.register("DeviceDetector",a),e.default=a},function(t,e,o){"use strict";var n,r=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),a=o(1),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.text="here",e}return r(e,t),e.prototype.render=function(){var t={position:"absolute",width:40,height:40,left:-20,top:-20,border:"5px solid #f44336",borderRadius:40,backgroundColor:"white",textAlign:"center",color:"#3f51b5",fontSize:16,fontWeight:"bold",padding:4};return i.createElement("div",{style:t},this.text)},e}(i.Component),s=function(t){function e(e){var o=t.call(this,e)||this;o.componentId="",o.flowKey="",o.attributes={},o.text="",o.componentId=e.id,o.flowKey=e.flowKey;var n=manywho.model.getComponent(o.props.id,o.props.flowKey);if(n.attributes)for(var r in n.attributes)o.attributes[r]=n.attributes[r];return o}return r(e,t),e.prototype.componentDidMount=function(){var t,e=manywho.model.getComponent(this.componentId,this.flowKey),o=manywho.state.getComponent(this.componentId,this.flowKey)||{};if(o.objectData[0]){var n=(t=o.objectData[0]).properties;this.longitude=manywho.utils.getObjectDataProperty(n,"Longitude").contentValue,this.latitude=manywho.utils.getObjectDataProperty(n,"Latitude").contentValue}else t=e.objectData[0];var r={objectData:[t=JSON.parse(JSON.stringify(t))]};manywho.state.setComponent(this.componentId,r,this.flowKey,!0),1==e.isEditable?this.detectLocation():this.forceUpdate()},e.prototype.componentDidUpdate=function(){},e.prototype.getAttribute=function(t){return this.attributes[t]?this.attributes[t]:null},e.prototype.save=function(){manywho.state.getComponent(this.componentId,this.flowKey);var t=manywho.model.getComponent(this.componentId,this.flowKey).objectData[0];(t=JSON.parse(JSON.stringify(t))).isSelected=!0,manywho.utils.setObjectDataProperty(t.properties,"OperatingSystem",this.operatingSystem),manywho.utils.setObjectDataProperty(t.properties,"BrowserVendor",this.browserVendor),manywho.utils.setObjectDataProperty(t.properties,"BrowserName",this.browserName),manywho.utils.setObjectDataProperty(t.properties,"Longitude",this.longitude),manywho.utils.setObjectDataProperty(t.properties,"Latitude",this.latitude);var e={objectData:[t]};manywho.state.setComponent(this.componentId,e,this.flowKey,!0),this.forceUpdate()},e.prototype.render=function(){var t,e=manywho.model.getComponent(this.componentId,this.flowKey),o=(manywho.state.getComponent(this.componentId,this.flowKey),this.getAttribute("Title"),parseInt(this.getAttribute("Zoom")||18)),n=(this.getAttribute("ApiKey"),e.width,e.height+"px"),r={};if(r.width="100%",r.height=n,this.longitude&&this.latitude){var s={lat:this.latitude,lng:this.longitude};t=i.createElement(a.default,{centre:s,zoom:o},i.createElement(p,{center:s,title:"Here"}))}return i.createElement("div",{style:r},t)},e.prototype.handleApiLoaded=function(t,e){},e.prototype.imhere=function(t){this.latitude=t.coords.latitude,this.longitude=t.coords.longitude,this.operatingSystem=navigator.platform,this.browserName=navigator.product,this.browserVendor=navigator.vendor,this.save()},e.prototype.detectLocation=function(){navigator.geolocation.getCurrentPosition(this.imhere.bind(this)),this.operatingSystem=navigator.platform,this.browserName=navigator.product,this.browserVendor=navigator.vendor,this.save()},e}(i.Component);manywho.component.register("WhereAmI",s),e.default=s},function(t,e,o){"use strict";var n,r=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0});var i=o(0);!function(t){function e(e){var o=t.call(this,e)||this;return o.googleMapsURL="https://maps.googleapis.com/maps/api/js?key=AIzaSyDZ2cbjJkFl5qygZYcKrcZVTzfX70G_-nY",o.onScriptLoaded=o.onScriptLoaded.bind(o),o}r(e,t),e.prototype.componentDidMount=function(){this.addMapsScript()},e.prototype.addMapsScript=function(){var t=this;document.querySelectorAll('[src="'+this.googleMapsURL+'"]').length?this.onScriptLoaded():document.body.appendChild(Object.assign(document.createElement("script"),{type:"text/javascript",src:this.googleMapsURL,onload:function(){return t.onScriptLoaded()}}))},e.prototype.onScriptLoaded=function(){var t={lng:parseInt(this.props.centre.lng),lat:parseInt(this.props.centre.lat)},e=this.props.title,o={position:t,map:this.props.map,title:e};new google.maps.Marker(o)},e.prototype.render=function(){return i.createElement("div",{style:{width:"100%",height:"100%"}})}}(i.Component);e.default=Map}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwiUmVhY3RcIiIsIndlYnBhY2s6Ly8vLi9zcmMvTWFwLnRzeCIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXgudHN4Iiwid2VicGFjazovLy8uL3NyYy9EZXZpY2VEZXRlY3Rvci50c3giLCJ3ZWJwYWNrOi8vLy4vc3JjL1doZXJlQW1JLnRzeCIsIndlYnBhY2s6Ly8vLi9zcmMvTWFya2VyLnRzeCJdLCJuYW1lcyI6WyJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsIlJlYWN0IiwiTWFwIiwiX3N1cGVyIiwicHJvcHMiLCJfdGhpcyIsInRoaXMiLCJnb29nbGVNYXBzVVJMIiwib25TY3JpcHRMb2FkZWQiLCJfX2V4dGVuZHMiLCJjb21wb25lbnREaWRNb3VudCIsImFkZE1hcHNTY3JpcHQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJsZW5ndGgiLCJib2R5IiwiYXBwZW5kQ2hpbGQiLCJhc3NpZ24iLCJjcmVhdGVFbGVtZW50IiwidHlwZSIsInNyYyIsIm9ubG9hZCIsIm9wdGlvbnMiLCJjZW50ZXIiLCJsbmciLCJwYXJzZUZsb2F0IiwiY2VudHJlIiwibGF0Iiwiem9vbSIsInBhcnNlSW50IiwibWFwIiwiZ29vZ2xlIiwibWFwcyIsImdldEVsZW1lbnRCeUlkIiwiY2hpbGRyZW4iLCJ0b1N0cmluZyIsImFycmF5IiwibVBvcyIsIm9wdHMiLCJwb3NpdGlvbiIsInRpdGxlIiwiTWFya2VyIiwib2JqIiwicmVuZGVyIiwic3R5bGUiLCJ3aWR0aCIsImhlaWdodCIsImlkIiwiQ29tcG9uZW50IiwiZGVmYXVsdCIsIl9fZXhwb3J0IiwiRGV2aWNlRGV0ZWN0b3IiLCJjb21wb25lbnRJZCIsImZsb3dLZXkiLCJhdHRyaWJ1dGVzIiwidGV4dCIsImZsb3dNb2RlbCIsIm1hbnl3aG8iLCJtb2RlbCIsImdldENvbXBvbmVudCIsImRldGVjdERldmljZSIsImNvbXBvbmVudERpZFVwZGF0ZSIsImdldEF0dHJpYnV0ZSIsImF0dHJpYnV0ZU5hbWUiLCJmbG93U3RhdGUiLCJzdGF0ZSIsImxhYmVsIiwicGxhdGZvcm0iLCJ2ZW5kb3IiLCJwcm9kdWN0IiwibGF0aXR1ZGUiLCJsb25naXR1ZGUiLCJjb250ZW50VmFsdWUiLCJpbWhlcmUiLCJyZXN1bHQiLCJjb29yZHMiLCJmb3JjZVVwZGF0ZSIsIm5hdmlnYXRvciIsImdlb2xvY2F0aW9uIiwiZ2V0Q3VycmVudFBvc2l0aW9uIiwiY29tcG9uZW50IiwicmVnaXN0ZXIiLCJNYXBfMSIsImFwcGx5IiwiYXJndW1lbnRzIiwiTWFya2VyU3R5bGUiLCJsZWZ0IiwidG9wIiwiYm9yZGVyIiwiYm9yZGVyUmFkaXVzIiwiYmFja2dyb3VuZENvbG9yIiwidGV4dEFsaWduIiwiY29sb3IiLCJmb250U2l6ZSIsImZvbnRXZWlnaHQiLCJwYWRkaW5nIiwiV2hlcmVBbUkiLCJvYmplY3REYXRhIiwicHJvcGVydGllcyIsInV0aWxzIiwiZ2V0T2JqZWN0RGF0YVByb3BlcnR5IiwibmV3U3RhdGUiLCJKU09OIiwicGFyc2UiLCJzdHJpbmdpZnkiLCJzZXRDb21wb25lbnQiLCJpc0VkaXRhYmxlIiwiZGV0ZWN0TG9jYXRpb24iLCJzYXZlIiwiaXNTZWxlY3RlZCIsInNldE9iamVjdERhdGFQcm9wZXJ0eSIsIm9wZXJhdGluZ1N5c3RlbSIsImJyb3dzZXJWZW5kb3IiLCJicm93c2VyTmFtZSIsInBvcyIsImhhbmRsZUFwaUxvYWRlZCJdLCJtYXBwaW5ncyI6ImFBQ0EsSUFBQUEsRUFBQSxHQUdBLFNBQUFDLEVBQUFDLEdBR0EsR0FBQUYsRUFBQUUsR0FDQSxPQUFBRixFQUFBRSxHQUFBQyxRQUdBLElBQUFDLEVBQUFKLEVBQUFFLEdBQUEsQ0FDQUcsRUFBQUgsRUFDQUksR0FBQSxFQUNBSCxRQUFBLElBVUEsT0FOQUksRUFBQUwsR0FBQU0sS0FBQUosRUFBQUQsUUFBQUMsSUFBQUQsUUFBQUYsR0FHQUcsRUFBQUUsR0FBQSxFQUdBRixFQUFBRCxRQUtBRixFQUFBUSxFQUFBRixFQUdBTixFQUFBUyxFQUFBVixFQUdBQyxFQUFBVSxFQUFBLFNBQUFSLEVBQUFTLEVBQUFDLEdBQ0FaLEVBQUFhLEVBQUFYLEVBQUFTLElBQ0FHLE9BQUFDLGVBQUFiLEVBQUFTLEVBQUEsQ0FBMENLLFlBQUEsRUFBQUMsSUFBQUwsS0FLMUNaLEVBQUFrQixFQUFBLFNBQUFoQixHQUNBLG9CQUFBaUIsZUFBQUMsYUFDQU4sT0FBQUMsZUFBQWIsRUFBQWlCLE9BQUFDLFlBQUEsQ0FBd0RDLE1BQUEsV0FFeERQLE9BQUFDLGVBQUFiLEVBQUEsY0FBaURtQixPQUFBLEtBUWpEckIsRUFBQXNCLEVBQUEsU0FBQUQsRUFBQUUsR0FFQSxHQURBLEVBQUFBLElBQUFGLEVBQUFyQixFQUFBcUIsSUFDQSxFQUFBRSxFQUFBLE9BQUFGLEVBQ0EsS0FBQUUsR0FBQSxpQkFBQUYsUUFBQUcsV0FBQSxPQUFBSCxFQUNBLElBQUFJLEVBQUFYLE9BQUFZLE9BQUEsTUFHQSxHQUZBMUIsRUFBQWtCLEVBQUFPLEdBQ0FYLE9BQUFDLGVBQUFVLEVBQUEsV0FBeUNULFlBQUEsRUFBQUssVUFDekMsRUFBQUUsR0FBQSxpQkFBQUYsRUFBQSxRQUFBTSxLQUFBTixFQUFBckIsRUFBQVUsRUFBQWUsRUFBQUUsRUFBQSxTQUFBQSxHQUFnSCxPQUFBTixFQUFBTSxJQUFxQkMs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LElBQUFDLEVBRUlGLEVBQUEvQixLQUFBa0MsS0FBTUYsSUFBTUUsWUFIaEJELEVBQUFFLGNBQWMsc0ZBSVZGLEVBQUtHLGVBQWlCSCxFQUFLRyxlQUFlZixLQUFLWSxLQVBsQ0ksRUFBQWdDLEVBQUF0QyxHQVdqQnNDLEVBQUE1QyxVQUFBYSxrQkFBQSxXQUdJSixLQUFLSyxpQkFLVDhCLEVBQUE1QyxVQUFBYyxjQUFBLGVBQUFOLEVBQUFDLEtBRVNNLFNBQVNDLGlCQUFpQixTQUFTUCxLQUFLQyxjQUFhLE1BQU1PLE9BUzlEUixLQUFLRSxpQkFQTEksU0FBU0csS0FBS0MsWUFBWXJDLE9BQU9zQyxPQUMvQkwsU0FBU00sY0FBYyxVQUFXLENBQ2hDQyxLQUFNLGtCQUNOQyxJQUFLZCxLQUFLQyxjQUNWYyxPQUFRLFdBQU0sT0FBQWhCLEVBQUtHLHNCQVEzQmlDLEVBQUE1QyxVQUFBVyxlQUFBLFdBR0UsSUFBSWtCLEVBQVMsQ0FBQ0YsSUFBS0ssU0FBU3ZCLEtBQUtGLE1BQU1zQixPQUFPRixLQUFPRyxJQUFLRSxTQUFTdkIsS0FBS0YsTUFBTXNCLE9BQU9DLE1BQ2pGYSxFQUFRbEMsS0FBS0YsTUFBTW9DLE1BTW5CRixFQUFPLENBQUNDLFNBQVViLEVBQVFJLElBSHBCeEIsS0FBS0YsTUFBTTBCLElBR29CVSxNQUFRQSxHQUNwQyxJQUFJVCxPQUFPQyxLQUFLUyxPQUFPSCxJQUl0Q0csRUFBQTVDLFVBQUE4QyxPQUFBLFdBRUUsT0FBTzFDLEVBQUFpQixjQUFBLE9BQUswQixNQUFPLENBQUVDLE1BQU8sT0FBUUMsT0FBUSxXQXBEcEQsQ0FBcUI3QyxFQUFNK0MsV0F3RDNCakYsRUFBQWtGLFFBQWUvQyIsImZpbGUiOiJEZXZpY2VEZXRlY3Rvci5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAyKTtcbiIsIm1vZHVsZS5leHBvcnRzID0gUmVhY3Q7IiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgKiBhcyBHb29nbGUgZnJvbSAnZ29vZ2xlLW1hcHMnO1xyXG5pbXBvcnQgTWFya2VyIGZyb20gJy4vTWFya2VyJztcclxuXHJcbmNsYXNzIE1hcCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCA8YW55LCBhbnk+XHJcbntcclxuXHJcbiAgICBnb29nbGVNYXBzVVJMPVwiaHR0cHM6Ly9tYXBzLmdvb2dsZWFwaXMuY29tL21hcHMvYXBpL2pzP2tleT1BSXphU3lEWjJjYmpKa0ZsNXF5Z1pZY0tyY1pWVHpmWDcwR18tbllcIjtcclxuICAgIGNvbnN0cnVjdG9yKHByb3BzIDogYW55KSBcclxuICAgIHtcclxuICAgICAgICBzdXBlcihwcm9wcyk7XHJcbiAgICAgICAgdGhpcy5vblNjcmlwdExvYWRlZCA9IHRoaXMub25TY3JpcHRMb2FkZWQuYmluZCh0aGlzKTtcclxuICAgIH1cclxuXHJcbiAgICAvL2ZpcmVzIHdoZW4gY29tcG9uZW50IGlzIG1vdW50ZWQgLyBjb21wbGV0ZVxyXG4gICAgY29tcG9uZW50RGlkTW91bnQoKSBcclxuICAgIHtcclxuICAgICAgICAvL3JlcXVlc3QgdGhlIGdvb2dsZSBtYXBzIGFwaSBzY3JpcHQgdG8gYmUgYWRkZWRcclxuICAgICAgICB0aGlzLmFkZE1hcHNTY3JpcHQoKTtcclxuICAgIH1cclxuXHJcbiAgICAvL3RoaXMgZnVuY3Rpb24gYWRkcyB0aGUgZ29vZ2xlIG1hcHMgc2NyaXB0IHRvIHRoZSBwYWdlXHJcbiAgICAvL3RoZSB0aGlzLm9uU2NyaXB0TG9hZGVkIG1ldGhvZCB3aWxsIGJlIGZpcmVkIHdoZW4gdGhlIHNjcmlwdCBoYXMgY29tcGxldGVkIGxvYWRpbmdcclxuICAgIGFkZE1hcHNTY3JpcHQoKSBcclxuICAgIHtcclxuICAgICAgICBpZiAoIWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYFtzcmM9XCIke3RoaXMuZ29vZ2xlTWFwc1VSTH1cIl1gKS5sZW5ndGgpIFxyXG4gICAgICAgIHsgXHJcbiAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKE9iamVjdC5hc3NpZ24oXHJcbiAgICAgICAgICAgIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpLCB7XHJcbiAgICAgICAgICAgICAgdHlwZTogJ3RleHQvamF2YXNjcmlwdCcsXHJcbiAgICAgICAgICAgICAgc3JjOiB0aGlzLmdvb2dsZU1hcHNVUkwsXHJcbiAgICAgICAgICAgICAgb25sb2FkOiAoKSA9PiB0aGlzLm9uU2NyaXB0TG9hZGVkKClcclxuICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICB0aGlzLm9uU2NyaXB0TG9hZGVkKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICAvL3RoaXMgaGFuZGxlciBmaXJlcyB3aGVuIHRoZSBnb29nbGUgbWFwcyBzY3JpcHQgaGFzIGxvYWRlZFxyXG4gICAgICBvblNjcmlwdExvYWRlZCgpXHJcbiAgICAgIHtcclxuICAgICAgICAvL2ZvcmNlIG51bWJlciBhcmdzIGludG8gZmxvYXRzICYgaW50c1xyXG4gICAgICAgIHZhciBjZW50cmUgPSB7bG5nOiBwYXJzZUZsb2F0KHRoaXMucHJvcHMuY2VudHJlLmxuZykgLCBsYXQ6IHBhcnNlRmxvYXQodGhpcy5wcm9wcy5jZW50cmUubGF0KSB9O1xyXG4gICAgICAgIHZhciB6b29tID0gcGFyc2VJbnQodGhpcy5wcm9wcy56b29tKTtcclxuICAgICAgICBcclxuICAgICAgICAvL2NyZWF0ZSBhIG5ldyBvcHRpb25zIG9iamVjdFxyXG4gICAgICAgIHZhciBvcHRpb25zID0ge2NlbnRlciA6IGNlbnRyZSwgem9vbSA6IHpvb219O1xyXG5cclxuICAgICAgICAvL2NyZWF0ZSBhIG1hcFxyXG4gICAgICAgIGNvbnN0IG1hcCA9IG5ldyBnb29nbGUubWFwcy5NYXAoIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibWFwXCIpLCBvcHRpb25zKTtcclxuXHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYodGhpcy5wcm9wcy5jaGlsZHJlbilcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHN3aXRjaChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodGhpcy5wcm9wcy5jaGlsZHJlbikpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgXCJbb2JqZWN0IEFycmF5XVwiOlxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBhcnJheSA9dGhpcy5wcm9wcy5jaGlsZHJlbiBhcyBhbnlbXTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IodmFyIG1Qb3MgPSAwIDsgbVBvcyA8IGFycmF5Lmxlbmd0aCA7IG1Qb3MrKylcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwb3NpdGlvbiA9IHtsbmc6IHBhcnNlRmxvYXQoYXJyYXlbbVBvc10ucHJvcHMuY2VudGVyLmxuZykgLCBsYXQ6IHBhcnNlRmxvYXQoYXJyYXlbbVBvc10ucHJvcHMuY2VudGVyLmxhdCkgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9wdHMgPSB7cG9zaXRpb246IHBvc2l0aW9uLCBtYXAgOiBtYXAsIHRpdGxlIDogYXJyYXlbbVBvc10ucHJvcHMudGl0bGUgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIob3B0cyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgXCJbb2JqZWN0IE9iamVjdF1cIjpcclxuICAgICAgICAgICAgICAgICAgICB2YXIgb2JqID0gdGhpcy5wcm9wcy5jaGlsZHJlbiBhcyBhbnk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBvc2l0aW9uID0ge2xuZzogcGFyc2VGbG9hdChvYmoucHJvcHMuY2VudGVyLmxuZykgLCBsYXQ6IHBhcnNlRmxvYXQob2JqLnByb3BzLmNlbnRlci5sYXQpIH07XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9wdHMgPSB7cG9zaXRpb246IHBvc2l0aW9uLCBtYXAgOiBtYXAsIHRpdGxlIDogb2JqLnByb3BzLnRpdGxlIH07XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIob3B0cyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICBcclxuICAgICAgcmVuZGVyKCkgXHJcbiAgICAgIHtcclxuICAgICAgICByZXR1cm4gPGRpdiBzdHlsZT17eyB3aWR0aDogJzEwMCUnLCBoZWlnaHQ6ICcxMDAlJyB9fSBpZD1cIm1hcFwiIC8+XHJcbiAgICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgTWFwXHJcbiIsImV4cG9ydCAqIGZyb20gJy4vRGV2aWNlRGV0ZWN0b3InO1xuZXhwb3J0ICogZnJvbSAnLi9XaGVyZUFtSSc7XG5leHBvcnQgKiBmcm9tICcuL01hcCc7XG5leHBvcnQgKiBmcm9tICcuL01hcmtlcic7XG5cbiIsImRlY2xhcmUgdmFyIG1hbnl3aG86IGFueTtcclxuXHJcbmltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuXHJcbmNsYXNzIERldmljZURldGVjdG9yIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PGFueSwgYW55PiBcclxueyAgIFxyXG4gICAgY29tcG9uZW50SWQ6IHN0cmluZyA9IFwiXCI7XHJcbiAgICBmbG93S2V5OiBzdHJpbmcgPVwiXCI7ICAgIFxyXG4gICAgYXR0cmlidXRlcyA6IGFueSA9IHt9O1xyXG4gICAgXHJcbiAgICBwbGF0Zm9ybTogc3RyaW5nO1xyXG4gICAgcHJvZHVjdCA6IHN0cmluZztcclxuICAgIGxhdGl0dWRlIDogYW55O1xyXG4gICAgbG9uZ2l0dWRlIDogYW55OyBcclxuICAgIGRldmljZTogc3RyaW5nO1xyXG4gICAgdmVuZG9yOiBzdHJpbmc7XHJcblxyXG4gICAgdGV4dCA6IHN0cmluZyA9IFwiXCI7XHJcblxyXG4gICAgY29uc3RydWN0b3IocHJvcHMgOiBhbnkpXHJcblx0e1xyXG4gICAgICAgIHN1cGVyKHByb3BzKTtcclxuICAgICAgICBcclxuICAgICAgICB0aGlzLmNvbXBvbmVudElkID0gcHJvcHMuaWQ7XHJcbiAgICAgICAgdGhpcy5mbG93S2V5ID0gcHJvcHMuZmxvd0tleTtcclxuXHJcbiAgICAgICAgLy9wdXNoIGF0dHJpYnV0ZXMgaW50byBrZXllZCBtYXAgXHJcblx0XHR2YXIgZmxvd01vZGVsID0gbWFueXdoby5tb2RlbC5nZXRDb21wb25lbnQodGhpcy5wcm9wcy5pZCwgICB0aGlzLnByb3BzLmZsb3dLZXkpO1xyXG5cdFx0aWYoZmxvd01vZGVsLmF0dHJpYnV0ZXMpXHJcblx0XHR7XHJcblx0XHRcdGZvcih2YXIga2V5IGluIGZsb3dNb2RlbC5hdHRyaWJ1dGVzKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0dGhpcy5hdHRyaWJ1dGVzW2tleV0gPSBmbG93TW9kZWwuYXR0cmlidXRlc1trZXldO1xyXG5cdFx0XHR9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIFxyXG4gICAgY29tcG9uZW50RGlkTW91bnQoKSBcclxuICAgIHtcclxuICAgICAgICB0aGlzLmRldGVjdERldmljZSgpO1xyXG4gICAgICAgIC8vdGhpcy5mb3JjZVVwZGF0ZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbXBvbmVudERpZFVwZGF0ZSgpXHJcbiAgICB7XHJcblxyXG4gICAgfVxyXG5cclxuXHRnZXRBdHRyaWJ1dGUoYXR0cmlidXRlTmFtZSA6IHN0cmluZylcclxuXHR7XHJcblx0XHRpZih0aGlzLmF0dHJpYnV0ZXNbYXR0cmlidXRlTmFtZV0pXHJcblx0XHR7XHJcblx0XHRcdHJldHVybiB0aGlzLmF0dHJpYnV0ZXNbYXR0cmlidXRlTmFtZV07XHJcblx0XHR9XHJcblx0XHRlbHNlXHJcblx0XHR7XHJcblx0XHRcdHJldHVybiBudWxsO1xyXG5cdFx0fVxyXG5cdH1cclxuICAgICAgIFxyXG4gICAgcmVuZGVyKClcclxuICAgIHtcclxuICAgICAgICBjb25zdCBmbG93TW9kZWwgPSBtYW55d2hvLm1vZGVsLmdldENvbXBvbmVudCh0aGlzLmNvbXBvbmVudElkLCAgIHRoaXMuZmxvd0tleSk7XHJcbiAgICAgICAgY29uc3QgZmxvd1N0YXRlID0gbWFueXdoby5zdGF0ZS5nZXRDb21wb25lbnQodGhpcy5jb21wb25lbnRJZCwgICB0aGlzLmZsb3dLZXkpO1xyXG5cclxuICAgICAgICB2YXIgZmlsZVBpY2sgOiBhbnk7XHJcbiAgICAgICAgdmFyIGNhcHRpb24gOiBzdHJpbmcgPSB0aGlzLmdldEF0dHJpYnV0ZShcIlRpdGxlXCIpIHx8IFwiU2VsZWN0IEZpbGVcIjtcclxuICAgICAgICB2YXIgd2lkdGggPSBmbG93TW9kZWwud2lkdGggKyBcInB4XCI7XHJcbiAgICAgICAgdmFyIGhlaWdodD1mbG93TW9kZWwuaGVpZ2h0ICsgXCJweFwiO1xyXG5cclxuICAgICAgICB2YXIgc3R5bGUgOiBhbnkgPSB7fTtcclxuICAgICAgICBzdHlsZS53aWR0aCA9IHdpZHRoO1xyXG4gICAgICAgIHN0eWxlLmhlaWdodCA9IGhlaWdodDtcclxuXHJcbiAgICAgICAgdmFyIGxhYmVsID0gXCJPUzpcIiArIHRoaXMucGxhdGZvcm0gKyBcIiBCcm93c2VyOlwiICsgdGhpcy52ZW5kb3IgKyBcIiAtIFwiICsgdGhpcy5wcm9kdWN0ICsgXCIgTGF0aXR1ZGU6XCIgKyB0aGlzLmxhdGl0dWRlICsgXCIgTG9uZ2l0dWRlOlwiICsgdGhpcy5sb25naXR1ZGU7XHJcblxyXG4gICAgICAgIGZsb3dTdGF0ZS5jb250ZW50VmFsdWU9bGFiZWw7XHJcbiAgICAgICAgcmV0dXJuIDxkaXY+e2xhYmVsfTwvZGl2PlxyXG4gICAgfVxyXG4gICBcclxuICAgIGltaGVyZShyZXN1bHQgOiBhbnkpXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5sYXRpdHVkZSA9IHJlc3VsdC5jb29yZHMubGF0aXR1ZGU7XHJcbiAgICAgICAgdGhpcy5sb25naXR1ZGUgPSByZXN1bHQuY29vcmRzLmxvbmdpdHVkZTtcclxuICAgICAgICB0aGlzLmZvcmNlVXBkYXRlKCk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGRldGVjdERldmljZSgpXHJcbiAgICAge1xyXG4gICAgICAgIHRoaXMucGxhdGZvcm0gPSBuYXZpZ2F0b3IucGxhdGZvcm07XHJcbiAgICAgICAgdGhpcy5wcm9kdWN0ID0gbmF2aWdhdG9yLnByb2R1Y3Q7XHJcbiAgICAgICAgdGhpcy52ZW5kb3IgPSBuYXZpZ2F0b3IudmVuZG9yO1xyXG4gICAgICAgIG5hdmlnYXRvci5nZW9sb2NhdGlvbi5nZXRDdXJyZW50UG9zaXRpb24odGhpcy5pbWhlcmUuYmluZCh0aGlzKSk7XHJcbiAgICAgICAgdmFyIGRldmljZU5hbWU7XHJcblxyXG4gICAgICAgIHJldHVybiBkZXZpY2VOYW1lO1xyXG4gICAgfVxyXG5cclxuICAgIFxyXG59XHJcblxyXG5tYW55d2hvLmNvbXBvbmVudC5yZWdpc3RlcignRGV2aWNlRGV0ZWN0b3InLCBEZXZpY2VEZXRlY3Rvcik7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBEZXZpY2VEZXRlY3RvcjtcclxuXHJcblxyXG4iLCJkZWNsYXJlIHZhciBtYW55d2hvOiBhbnk7XHJcblxyXG5pbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCBNYXAgZnJvbSAnLi9NYXAnO1xyXG5cclxuY2xhc3MgTWFya2VyIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PGFueSwgYW55PiBcclxue1xyXG4gICAgdGV4dCA6IHN0cmluZyA9IFwiaGVyZVwiO1xyXG4gICAgcmVuZGVyKClcclxuICAgIHtcclxuICAgICAgICBjb25zdCBLX1dJRFRIID0gNDA7XHJcbiAgICAgICAgY29uc3QgS19IRUlHSFQgPSA0MDtcclxuXHJcbiAgICAgICAgY29uc3QgTWFya2VyU3R5bGUgPSB7XHJcbiAgICAgICAgICAgIC8vIGluaXRpYWxseSBhbnkgbWFwIG9iamVjdCBoYXMgbGVmdCB0b3AgY29ybmVyIGF0IGxhdCBsbmcgY29vcmRpbmF0ZXNcclxuICAgICAgICAgICAgLy8gaXQncyBvbiB5b3UgdG8gc2V0IG9iamVjdCBvcmlnaW4gdG8gMCwwIGNvb3JkaW5hdGVzXHJcbiAgICAgICAgICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnIGFzICdhYnNvbHV0ZScsXHJcbiAgICAgICAgICAgIHdpZHRoOiBLX1dJRFRILFxyXG4gICAgICAgICAgICBoZWlnaHQ6IEtfSEVJR0hULFxyXG4gICAgICAgICAgICBsZWZ0OiAtS19XSURUSCAvIDIsXHJcbiAgICAgICAgICAgIHRvcDogLUtfSEVJR0hUIC8gMixcclxuICAgICAgICAgICAgYm9yZGVyOiAnNXB4IHNvbGlkICNmNDQzMzYnLFxyXG4gICAgICAgICAgICBib3JkZXJSYWRpdXM6IEtfSEVJR0hULFxyXG4gICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6ICd3aGl0ZScsXHJcbiAgICAgICAgICAgIHRleHRBbGlnbjogJ2NlbnRlcicgYXMgJ2NlbnRyZScsXHJcbiAgICAgICAgICAgIGNvbG9yOiAnIzNmNTFiNScsXHJcbiAgICAgICAgICAgIGZvbnRTaXplOiAxNixcclxuICAgICAgICAgICAgZm9udFdlaWdodDogJ2JvbGQnIGFzICdib2xkJyxcclxuICAgICAgICAgICAgcGFkZGluZzogNFxyXG4gICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgcmV0dXJuIDxkaXYgc3R5bGU9e01hcmtlclN0eWxlfT57dGhpcy50ZXh0fTwvZGl2PlxyXG4gICAgfVxyXG59XHJcblxyXG5jbGFzcyBXaGVyZUFtSSBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxhbnksIGFueT4gXHJcbnsgICBcclxuICAgIGNvbXBvbmVudElkOiBzdHJpbmcgPSBcIlwiO1xyXG4gICAgZmxvd0tleTogc3RyaW5nID1cIlwiOyAgICBcclxuICAgIGF0dHJpYnV0ZXMgOiBhbnkgPSB7fTtcclxuICAgIFxyXG4gICAgcGxhdGZvcm06IHN0cmluZztcclxuICAgIHByb2R1Y3QgOiBzdHJpbmc7XHJcbiAgICBsYXRpdHVkZSA6IGFueTtcclxuICAgIGxvbmdpdHVkZSA6IGFueTsgXHJcbiAgICBkZXZpY2U6IHN0cmluZztcclxuICAgIHZlbmRvcjogc3RyaW5nO1xyXG5cclxuICAgIG9wZXJhdGluZ1N5c3RlbSA6IHN0cmluZztcclxuICAgIGJyb3dzZXJOYW1lIDogc3RyaW5nO1xyXG4gICAgYnJvd3NlclZlbmRvciA6IHN0cmluZztcclxuXHJcbiAgICB0ZXh0IDogc3RyaW5nID0gXCJcIjtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihwcm9wcyA6IGFueSlcclxuXHR7XHJcbiAgICAgICAgc3VwZXIocHJvcHMpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMuY29tcG9uZW50SWQgPSBwcm9wcy5pZDtcclxuICAgICAgICB0aGlzLmZsb3dLZXkgPSBwcm9wcy5mbG93S2V5O1xyXG5cclxuICAgICAgICAvL3B1c2ggYXR0cmlidXRlcyBpbnRvIGtleWVkIG1hcCBcclxuXHRcdHZhciBmbG93TW9kZWwgPSBtYW55d2hvLm1vZGVsLmdldENvbXBvbmVudCh0aGlzLnByb3BzLmlkLCAgIHRoaXMucHJvcHMuZmxvd0tleSk7XHJcblx0XHRpZihmbG93TW9kZWwuYXR0cmlidXRlcylcclxuXHRcdHtcclxuXHRcdFx0Zm9yKHZhciBrZXkgaW4gZmxvd01vZGVsLmF0dHJpYnV0ZXMpXHJcblx0XHRcdHtcclxuXHRcdFx0XHR0aGlzLmF0dHJpYnV0ZXNba2V5XSA9IGZsb3dNb2RlbC5hdHRyaWJ1dGVzW2tleV07XHJcblx0XHRcdH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgXHJcbiAgICBjb21wb25lbnREaWRNb3VudCgpIFxyXG4gICAge1xyXG4gICAgICAgIGNvbnN0IGZsb3dNb2RlbCA9IG1hbnl3aG8ubW9kZWwuZ2V0Q29tcG9uZW50KHRoaXMuY29tcG9uZW50SWQsICAgdGhpcy5mbG93S2V5KTtcclxuICAgICAgICBjb25zdCBmbG93U3RhdGUgPSBtYW55d2hvLnN0YXRlLmdldENvbXBvbmVudCh0aGlzLmNvbXBvbmVudElkLCB0aGlzLmZsb3dLZXkpIHx8IHt9O1xyXG5cclxuICAgICAgICB2YXIgb2JqZWN0RGF0YSA6IGFueTtcclxuICAgICAgICBpZihmbG93U3RhdGUub2JqZWN0RGF0YVswXSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIG9iamVjdERhdGE9Zmxvd1N0YXRlLm9iamVjdERhdGFbMF07XHJcbiAgICAgICAgICAgIHZhciBwcm9wcyA9IG9iamVjdERhdGEucHJvcGVydGllcztcclxuICAgICAgICAgICAgdGhpcy5sb25naXR1ZGUgPSBtYW55d2hvLnV0aWxzLmdldE9iamVjdERhdGFQcm9wZXJ0eShwcm9wcywgXCJMb25naXR1ZGVcIikuY29udGVudFZhbHVlO1xyXG4gICAgICAgICAgICB0aGlzLmxhdGl0dWRlID0gbWFueXdoby51dGlscy5nZXRPYmplY3REYXRhUHJvcGVydHkocHJvcHMsIFwiTGF0aXR1ZGVcIikuY29udGVudFZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBvYmplY3REYXRhPWZsb3dNb2RlbC5vYmplY3REYXRhWzBdO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgb2JqZWN0RGF0YSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkob2JqZWN0RGF0YSkpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHZhciBuZXdTdGF0ZSA9IHtcclxuXHRcdFx0b2JqZWN0RGF0YTogW29iamVjdERhdGFdXHJcblx0XHR9O1xyXG4gICAgICAgICAgICAgXHJcbiAgICAgICAgbWFueXdoby5zdGF0ZS5zZXRDb21wb25lbnQodGhpcy5jb21wb25lbnRJZCwgbmV3U3RhdGUsIHRoaXMuZmxvd0tleSwgdHJ1ZSk7XHJcblxyXG4gICAgICAgIGlmKGZsb3dNb2RlbC5pc0VkaXRhYmxlID09IHRydWUpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB0aGlzLmRldGVjdExvY2F0aW9uKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2VcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRoaXMuZm9yY2VVcGRhdGUoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGNvbXBvbmVudERpZFVwZGF0ZSgpXHJcbiAgICB7XHJcblxyXG4gICAgfVxyXG5cclxuXHRnZXRBdHRyaWJ1dGUoYXR0cmlidXRlTmFtZSA6IHN0cmluZylcclxuXHR7XHJcblx0XHRpZih0aGlzLmF0dHJpYnV0ZXNbYXR0cmlidXRlTmFtZV0pXHJcblx0XHR7XHJcblx0XHRcdHJldHVybiB0aGlzLmF0dHJpYnV0ZXNbYXR0cmlidXRlTmFtZV07XHJcblx0XHR9XHJcblx0XHRlbHNlXHJcblx0XHR7XHJcblx0XHRcdHJldHVybiBudWxsO1xyXG5cdFx0fVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBzYXZlKClcclxuICAgIHtcclxuXHJcbiAgICAgICAgY29uc3QgZmxvd1N0YXRlID0gbWFueXdoby5zdGF0ZS5nZXRDb21wb25lbnQodGhpcy5jb21wb25lbnRJZCwgdGhpcy5mbG93S2V5KSB8fCB7fTtcclxuICAgICAgICBjb25zdCBmbG93TW9kZWwgPSBtYW55d2hvLm1vZGVsLmdldENvbXBvbmVudCh0aGlzLmNvbXBvbmVudElkLCAgIHRoaXMuZmxvd0tleSk7XHJcblxyXG4gICAgICAgIHZhciBvYmplY3REYXRhID0gZmxvd01vZGVsLm9iamVjdERhdGFbMF07XHJcblxyXG4gICAgICAgIG9iamVjdERhdGEgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KG9iamVjdERhdGEpKTtcclxuXHJcbiAgICAgICAgb2JqZWN0RGF0YS5pc1NlbGVjdGVkID0gdHJ1ZTtcclxuICAgICAgICBcclxuICAgICAgICBtYW55d2hvLnV0aWxzLnNldE9iamVjdERhdGFQcm9wZXJ0eShvYmplY3REYXRhLnByb3BlcnRpZXMsIFwiT3BlcmF0aW5nU3lzdGVtXCIsIHRoaXMub3BlcmF0aW5nU3lzdGVtKTtcclxuICAgICAgICBtYW55d2hvLnV0aWxzLnNldE9iamVjdERhdGFQcm9wZXJ0eShvYmplY3REYXRhLnByb3BlcnRpZXMsIFwiQnJvd3NlclZlbmRvclwiLCB0aGlzLmJyb3dzZXJWZW5kb3IpO1xyXG4gICAgICAgIG1hbnl3aG8udXRpbHMuc2V0T2JqZWN0RGF0YVByb3BlcnR5KG9iamVjdERhdGEucHJvcGVydGllcywgXCJCcm93c2VyTmFtZVwiLCB0aGlzLmJyb3dzZXJOYW1lKTtcclxuICAgICAgICBtYW55d2hvLnV0aWxzLnNldE9iamVjdERhdGFQcm9wZXJ0eShvYmplY3REYXRhLnByb3BlcnRpZXMsIFwiTG9uZ2l0dWRlXCIsIHRoaXMubG9uZ2l0dWRlKTtcclxuICAgICAgICBtYW55d2hvLnV0aWxzLnNldE9iamVjdERhdGFQcm9wZXJ0eShvYmplY3REYXRhLnByb3BlcnRpZXMsIFwiTGF0aXR1ZGVcIiwgdGhpcy5sYXRpdHVkZSk7XHJcblxyXG4gICAgICAgIHZhciBuZXdTdGF0ZSA9IHtcclxuICAgICAgICAgICAgb2JqZWN0RGF0YTogW29iamVjdERhdGFdXHJcbiAgICAgICAgfTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgbWFueXdoby5zdGF0ZS5zZXRDb21wb25lbnQodGhpcy5jb21wb25lbnRJZCwgbmV3U3RhdGUsIHRoaXMuZmxvd0tleSwgdHJ1ZSk7XHJcblxyXG4gICAgICAgIHRoaXMuZm9yY2VVcGRhdGUoKTtcclxuICAgIH1cclxuICAgICAgIFxyXG4gICAgcmVuZGVyKClcclxuICAgIHtcclxuICAgICAgICBjb25zdCBmbG93TW9kZWwgPSBtYW55d2hvLm1vZGVsLmdldENvbXBvbmVudCh0aGlzLmNvbXBvbmVudElkLCAgIHRoaXMuZmxvd0tleSk7XHJcbiAgICAgICAgY29uc3QgZmxvd1N0YXRlID0gbWFueXdoby5zdGF0ZS5nZXRDb21wb25lbnQodGhpcy5jb21wb25lbnRJZCwgICB0aGlzLmZsb3dLZXkpO1xyXG5cclxuICAgICAgICB2YXIgY2FwdGlvbiA6IHN0cmluZyA9IHRoaXMuZ2V0QXR0cmlidXRlKFwiVGl0bGVcIikgfHwgXCJTZWxlY3QgRmlsZVwiO1xyXG4gICAgICAgIHZhciB6b29tIDogbnVtYmVyID0gcGFyc2VJbnQodGhpcy5nZXRBdHRyaWJ1dGUoXCJab29tXCIpIHx8IDE4KTtcclxuICAgICAgICB2YXIgYXBpS2V5ID0gdGhpcy5nZXRBdHRyaWJ1dGUoXCJBcGlLZXlcIikgfHwgXCJcIjtcclxuICAgICAgICB2YXIgd2lkdGggPSBmbG93TW9kZWwud2lkdGggKyBcInB4XCI7XHJcbiAgICAgICAgdmFyIGhlaWdodD1mbG93TW9kZWwuaGVpZ2h0ICsgXCJweFwiO1xyXG5cclxuICAgICAgICB2YXIgc3R5bGUgOiBhbnkgPSB7fTtcclxuICAgICAgICBzdHlsZS53aWR0aCA9ICcxMDAlJztcclxuICAgICAgICBzdHlsZS5oZWlnaHQgPSBoZWlnaHQ7XHJcblxyXG5cclxuICAgICAgICB2YXIgbWFwIDogYW55O1xyXG5cclxuICAgICAgICBpZih0aGlzLmxvbmdpdHVkZSAmJiB0aGlzLmxhdGl0dWRlKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdmFyIHBvcyA9IHtsYXQ6IHRoaXMubGF0aXR1ZGUsIGxuZzogdGhpcy5sb25naXR1ZGV9O1xyXG4gICAgICAgICAgICAvL3ZhciBtYXJrZXJzID0gW3twb3NpdGlvbjogcG9zLCB0aXRsZTogXCJIZXJlXCJ9XTtcclxuICAgICAgICAgICAgLy92YXIgb3B0aW9ucyA9IHtjZW50ZXI6cG9zLCB6b29tOnpvb219O1xyXG5cclxuICAgICAgICAgICAgbWFwID0gPE1hcCBjZW50cmU9e3Bvc30gem9vbT17em9vbX0+XHJcbiAgICAgICAgICAgICAgICA8TWFya2VyIGNlbnRlcj17cG9zfSB0aXRsZT1cIkhlcmVcIj48L01hcmtlcj5cclxuICAgICAgICAgICAgPC9NYXA+XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiAgPGRpdiBzdHlsZT17c3R5bGV9PnttYXB9PC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgXHJcblxyXG4gICAgfVxyXG4gICBcclxuICAgIGhhbmRsZUFwaUxvYWRlZChtYXAgOiBhbnksIG1hcHMgOiBhbnkpXHJcbiAgICB7XHJcbiAgICAgICAgdmFyIHggPSBtYXA7XHJcbiAgICB9XHJcblxyXG4gICAgaW1oZXJlKHJlc3VsdCA6IGFueSlcclxuICAgIHtcclxuICAgICAgICB0aGlzLmxhdGl0dWRlID0gcmVzdWx0LmNvb3Jkcy5sYXRpdHVkZTtcclxuICAgICAgICB0aGlzLmxvbmdpdHVkZSA9IHJlc3VsdC5jb29yZHMubG9uZ2l0dWRlO1xyXG4gICAgICAgIHRoaXMub3BlcmF0aW5nU3lzdGVtID0gbmF2aWdhdG9yLnBsYXRmb3JtO1xyXG4gICAgICAgIHRoaXMuYnJvd3Nlck5hbWUgPSBuYXZpZ2F0b3IucHJvZHVjdDtcclxuICAgICAgICB0aGlzLmJyb3dzZXJWZW5kb3IgPSBuYXZpZ2F0b3IudmVuZG9yO1xyXG4gICAgICAgIHRoaXMuc2F2ZSgpO1xyXG4gICAgICAgIFxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBkZXRlY3RMb2NhdGlvbigpXHJcbiAgICB7XHJcbiAgICAgICAgbmF2aWdhdG9yLmdlb2xvY2F0aW9uLmdldEN1cnJlbnRQb3NpdGlvbih0aGlzLmltaGVyZS5iaW5kKHRoaXMpKTtcclxuICAgICAgICB0aGlzLm9wZXJhdGluZ1N5c3RlbSA9IG5hdmlnYXRvci5wbGF0Zm9ybTtcclxuICAgICAgICB0aGlzLmJyb3dzZXJOYW1lID0gbmF2aWdhdG9yLnByb2R1Y3Q7XHJcbiAgICAgICAgdGhpcy5icm93c2VyVmVuZG9yID0gbmF2aWdhdG9yLnZlbmRvcjtcclxuICAgICAgICB0aGlzLnNhdmUoKTtcclxuICAgIH1cclxuXHJcbiAgICBcclxufVxyXG5cclxubWFueXdoby5jb21wb25lbnQucmVnaXN0ZXIoJ1doZXJlQW1JJywgV2hlcmVBbUkpO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgV2hlcmVBbUk7XHJcblxyXG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCAqIGFzIEdvb2dsZSBmcm9tICdnb29nbGUtbWFwcyc7XHJcblxyXG5jbGFzcyBNYXJrZXIgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQgPGFueSwgYW55PlxyXG57XHJcblxyXG4gICAgZ29vZ2xlTWFwc1VSTD1cImh0dHBzOi8vbWFwcy5nb29nbGVhcGlzLmNvbS9tYXBzL2FwaS9qcz9rZXk9QUl6YVN5RFoyY2JqSmtGbDVxeWdaWWNLcmNaVlR6Zlg3MEdfLW5ZXCI7XHJcbiAgICBjb25zdHJ1Y3Rvcihwcm9wcyA6IGFueSkgXHJcbiAgICB7XHJcbiAgICAgICAgc3VwZXIocHJvcHMpO1xyXG4gICAgICAgIHRoaXMub25TY3JpcHRMb2FkZWQgPSB0aGlzLm9uU2NyaXB0TG9hZGVkLmJpbmQodGhpcyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy9maXJlcyB3aGVuIGNvbXBvbmVudCBpcyBtb3VudGVkIC8gY29tcGxldGVcclxuICAgIGNvbXBvbmVudERpZE1vdW50KCkgXHJcbiAgICB7XHJcbiAgICAgICAgLy9yZXF1ZXN0IHRoZSBnb29nbGUgbWFwcyBhcGkgc2NyaXB0IHRvIGJlIGFkZGVkXHJcbiAgICAgICAgdGhpcy5hZGRNYXBzU2NyaXB0KCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy90aGlzIGZ1bmN0aW9uIGFkZHMgdGhlIGdvb2dsZSBtYXBzIHNjcmlwdCB0byB0aGUgcGFnZVxyXG4gICAgLy90aGUgdGhpcy5vblNjcmlwdExvYWRlZCBtZXRob2Qgd2lsbCBiZSBmaXJlZCB3aGVuIHRoZSBzY3JpcHQgaGFzIGNvbXBsZXRlZCBsb2FkaW5nXHJcbiAgICBhZGRNYXBzU2NyaXB0KCkgXHJcbiAgICB7XHJcbiAgICAgICAgaWYgKCFkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGBbc3JjPVwiJHt0aGlzLmdvb2dsZU1hcHNVUkx9XCJdYCkubGVuZ3RoKSBcclxuICAgICAgICB7IFxyXG4gICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChPYmplY3QuYXNzaWduKFxyXG4gICAgICAgICAgICBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKSwge1xyXG4gICAgICAgICAgICAgIHR5cGU6ICd0ZXh0L2phdmFzY3JpcHQnLFxyXG4gICAgICAgICAgICAgIHNyYzogdGhpcy5nb29nbGVNYXBzVVJMLFxyXG4gICAgICAgICAgICAgIG9ubG9hZDogKCkgPT4gdGhpcy5vblNjcmlwdExvYWRlZCgpXHJcbiAgICAgICAgICAgIH0pKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgdGhpcy5vblNjcmlwdExvYWRlZCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgLy90aGlzIGhhbmRsZXIgZmlyZXMgd2hlbiB0aGUgZ29vZ2xlIG1hcHMgc2NyaXB0IGhhcyBsb2FkZWRcclxuICAgICAgb25TY3JpcHRMb2FkZWQoKVxyXG4gICAgICB7XHJcbiAgICAgICAgLy9mb3JjZSBudW1iZXIgYXJncyBpbnRvIGludHNcclxuICAgICAgICB2YXIgY2VudHJlID0ge2xuZzogcGFyc2VJbnQodGhpcy5wcm9wcy5jZW50cmUubG5nKSAsIGxhdDogcGFyc2VJbnQodGhpcy5wcm9wcy5jZW50cmUubGF0KSB9O1xyXG4gICAgICAgIHZhciB0aXRsZSA9IHRoaXMucHJvcHMudGl0bGU7XHJcblxyXG4gICAgICAgIC8vZ2V0IHBhcmVudCBtYXBcclxuICAgICAgICB2YXIgbWFwID0gdGhpcy5wcm9wcy5tYXA7XHJcbiAgICAgICAgLy9jb25zdCBtYXAgPSBuZXcgZ29vZ2xlLm1hcHMuTWFwKCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm1hcFwiKSwgb3B0aW9ucyk7XHJcblxyXG4gICAgICAgIHZhciBvcHRzID0ge3Bvc2l0aW9uOiBjZW50cmUsIG1hcCA6IG1hcCwgdGl0bGUgOiB0aXRsZSB9XHJcbiAgICAgICAgdmFyIG1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIob3B0cyk7XHJcblxyXG4gICAgICB9XHJcbiAgICBcclxuICAgICAgcmVuZGVyKCkgXHJcbiAgICAgIHtcclxuICAgICAgICByZXR1cm4gPGRpdiBzdHlsZT17eyB3aWR0aDogJzEwMCUnLCBoZWlnaHQ6ICcxMDAlJyB9fSAgLz5cclxuICAgICAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBNYXBcclxuIl0sInNvdXJjZVJvb3QiOiIifQ==